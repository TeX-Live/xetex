\def\abjad#1{%
\ifnum#1>1999 \PackageWarning{polyglossia}{Illegal value (#1) for abjad numeral} {#1}
\else
  \ifnum#1<\z@\space\PackageWarning{polyglossia}{Illegal value (#1) for abjad numeral}%
  \else
    \ifnum#1<10\expandafter\abj@num@i\number#1%
    \else
      \ifnum#1<100\expandafter\abj@num@ii\number#1%
      \else
        \ifnum#1<\@m\expandafter\abj@num@iii\number#1%
        \else
          \ifnum#1<\@M\expandafter\abj@num@iv\number#1%since #1<2000, we must have 1000
          \fi
        \fi
      \fi
    \fi
  \fi
\fi
}

\def\abjadmaghribi#1{%
\ifnum#1>1999 \PackageWarning{polyglossia}{Illegal value (#1) for abjad numeral} {#1}
\else
  \ifnum#1<\z@\space\PackageWarning{polyglossia}{Illegal value (#1) for abjad numeral}%
  \else
    \ifnum#1<10\expandafter\abj@num@i\number#1%
    \else
      \ifnum#1<100\expandafter\abj@maghribi@num@ii\number#1%
      \else
        \ifnum#1<\@m\expandafter\abj@maghribi@num@iii\number#1%
        \else
          \ifnum#1<\@M\expandafter\abj@maghribi@num@iv\number#1%
          \fi
        \fi
      \fi
    \fi
  \fi
\fi
}

\def\abjad@zero{}
\def\abj@num@i#1{%
  \ifcase#1\or ا \or ب \or ج\char"200D\or د % 
           \or ه \or و \or ز \or ح \or ط \fi
  \ifnum#1=\z@\abjad@zero\fi}
\def\abj@num@ii#1{%
  \ifcase#1\or ي \or ك \or ل \or م \or ن %
           \or س \or ع \or ف \or ص \fi 
  \ifnum#1=\z@\fi\abj@num@i}
\def\abj@num@iii#1{%
  \ifcase#1\or ق \or ر \or ش \or ت \or ث %
            \or خ \or ذ \or ض \or ظ \fi
  \ifnum#1=\z@\fi\abj@num@ii}
\def\abj@num@iv#1{%
  \ifcase#1\or غ \fi
  \ifnum#1=\z@\fi\abj@num@iii}

%maghribi س -> ص ص -> ض ش -> س ض -> ظ ظ -> غ غ -> ش
\def\abj@maghribi@num@ii#1{%
  \ifcase#1\or ي \or ك \or ل \or م \or ن %
           \or ص \or ع \or ف \or ض \fi 
  \ifnum#1=\z@\abjad@zero\fi\abj@num@i}
\def\abj@maghribi@num@iii#1{%
  \ifcase#1\or ق \or ر \or س \or ت \or ث %
           \or خ \or ذ \or ظ \or غ \fi
  \ifnum#1=\z@\fi\abj@maghribi@num@ii}
\def\abj@maghribi@num@iv#1{%
  \ifcase#1\or ش \fi
  \ifnum#1=\z@\fi\abj@maghribi@num@iii}

\endinput
