% THIS IS TO BE LOADED IN THE XELATEX FORMAT
%
\let\xpg@tempa\ProvidesFile
\def\ProvidesFile#1[#2 #3 #4]{%
   \toks8{Polyglossia <#3> and hyphenation patterns for }%
   \xpg@tempa#1[#2 #3 #4]%
   \let\ProvidesFile\xpg@tempa}
\def\ProvidesLanguage#1{%
   \begingroup
      \catcode`\ 10 %
      \@makeother\/%
      \@ifnextchar[%]
         {\@provideslanguage{#1}}{\@provideslanguage{#1}[]}}
\def\@provideslanguage#1[#2]{%
   \wlog{Language: #1 #2}%
      \expandafter\xdef\csname ver@#1.ldf\endcsname{#2}%
      \endgroup}
\ProvidesFile{hyphen.cfg}
   [2008/07/28 v1.0.1 %
   Polyglossia language switching mechanism (adapted from antomega and babel)]
\countdef\last@language=19
\def\addlanguage{\alloc@9\language\chardef\@cclvi}
\def\adddialect#1#2{%
   \global\chardef#1#2\relax
   \wlog{\string#1 = a dialect from \string\language#2}}
\def\hyphenrules#1{%
   \expandafter\ifx\csname l@#1\endcsname\relax
      \PackageWarning{polyglossia}{Sorry: #1 is not a known language: check your file language.dat and regenerate xelatex.fmt.}%
   \else
      \language=\csname l@#1\endcsname\relax
   \fi
}
\def\endhyphenrules{}
\def\providehyphenmins#1#2{%
  \expandafter\ifx\csname #1hyphenmins\endcsname\relax
    \@namedef{#1hyphenmins}{#2}%
  \fi}
\def\set@hyphenmins#1#2{\lefthyphenmin#1\righthyphenmin#2\relax}
\def\process@line#1#2 #3/{%
   \ifx=#1
      \process@synonym#2 /
   \else
      \process@language#1#2 #3/%
   \fi
}
\toks@{}
\def\process@synonym#1 /{%
   \ifnum\last@language=\m@ne
      \expandafter\chardef\csname l@#1\endcsname0\relax
      \wlog{\string\l@#1=\string\language0}
      \toks@\expandafter{\the\toks@
         \expandafter\let\csname #1hyphenmins\expandafter\endcsname
         \csname\languagename hyphenmins\endcsname}%
   \else
      \expandafter\chardef\csname l@#1\endcsname\last@language
      \wlog{\string\l@#1=\string\language\the\last@language}
      \expandafter\let\csname #1hyphenmins\expandafter\endcsname
      \csname\languagename hyphenmins\endcsname
   \fi
  }
\def\process@language#1 #2 #3/{%
   \expandafter\addlanguage\csname l@#1\endcsname
   \expandafter\language\csname l@#1\endcsname
   \def\languagename{#1}%
   \global\toks8\expandafter{\the\toks8#1, }%
   \begingroup
      \lefthyphenmin\m@ne
      \input #2\relax
      \ifnum\lefthyphenmin=\m@ne
      \else
         \expandafter\xdef\csname #1hyphenmins\endcsname{%
            \set@hyphenmins{\the\lefthyphenmin}{\the\righthyphenmin}}%
      \fi
   \endgroup
   \ifnum\the\language=\z@
      \expandafter\ifx\csname #1hyphenmins\endcsname\relax
         \set@hyphenmins\tw@\thr@@\relax
      \else
         \expandafter\expandafter\expandafter\set@hyphenmins
            \csname #1hyphenmins\endcsname\relax
      \fi
      \the\toks@
   \fi
   \toks@{}%
   \def\xpg@tempa{#3}%
   \ifx\xpg@tempa\@empty
   \else
      \ifx\xpg@tempa\space
      \else
         \input #3\relax
      \fi
   \fi
}
\openin1 = language.dat
\ifeof1
  \message{I couldn't find the file language.dat,\space
           I will try the file hyphen.tex}
  \input hyphen.tex\relax
\else
  \last@language\m@ne
  \loop
    \endlinechar\m@ne
    \read1 to \xpg@line
    \endlinechar`\^^M
    \ifx\xpg@line\@empty
    \else
      \edef\xpg@line{\xpg@line\space/}%
      \expandafter\process@line\xpg@line
    \fi
    \iftrue \csname fi\endcsname
    \csname if\ifeof1 false\else true\fi\endcsname
  \repeat
  \language=0
\fi
\closein1
\let\process@language\@undefined
\let\process@synonym\@undefined
\let\process@line\@undefined
\let\xpg@tempa\@undefined
\let\xpg@tempb\@undefined
\let\xpg@eq@\@undefined
\let\xpg@line\@undefined
\ifx\addto@hook\@undefined
\else
  \expandafter\addto@hook\expandafter\everyjob\expandafter{%
    \expandafter\typeout\expandafter{\the\toks8 loaded.}}
\fi
\endinput
